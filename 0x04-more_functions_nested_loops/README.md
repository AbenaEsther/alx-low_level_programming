more functions and more nested loopds
